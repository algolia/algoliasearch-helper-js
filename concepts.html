<!DOCTYPE html><html><head><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta charset="utf-8"><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport"><link href="#" rel="icon" type="image/x-icon"><meta content="The Algolia JS Helper is the toolbox to create advanced search experience " name="description"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><!-- / Twitter card--><meta content="summary_large_image" name="twitter:card"><meta content="@Algolia" name="twitter:site"><meta content="@Algolia" name="twitter:creator"><meta content="Algolia JS Helper" name="twitter:title"><meta content="The Algolia JS Helper is the toolbox to create advanced search experience " name="twitter:description"><meta content="Algolia Product image" name="twitter:image"><!-- / OG meta--><meta content="https://community.algolia.com/algoliasearch-helper-js/" property="og:url"><meta content="Algolia JS Helper documentation" property="og:title"><meta content="#" property="og:image"><meta content="article" property="og:type"><meta content="The Algolia JS Helper is the toolbox to create advanced search experience " property="og:description"><meta content="Algolia JS Helper" property="og:site_name"><!-- Use title if it's in the page YAML frontmatter--><title>Helper core concepts</title><link href="https://fonts.googleapis.com/css?family=Montserrat:500,600|Open+Sans" rel="stylesheet" type="text/css"><link rel="stylesheet" href="css/index.css"><link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/github.min.css"><!-- Google Tag Manager--><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-N8JP8G" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N8JP8G');</script></head><body><nav class="algc-navigation"><div class="algc-navigation__container"><div class="algc-mainmenu"><ul class="algc-navigation__brands"><li class="algc-navigation__li algc-navigation__li--algolia"><a href="https://www.algolia.com/"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 117" width="70" height="16"><path fill="#FFF" d="M249.5 64.2V1.4c0-.9-.7-1.5-1.6-1.4L236.2 2a1.4 1.4 0 0 0-1.2 1.3V67c0 3 0 21.6 22.4 22.3a1.4 1.4 0 0 0 1.5-1.4v-9.5c0-.7-.6-1.3-1.2-1.4-8.2-.9-8.2-11-8.2-12.7ZM443.5 24.4h-11.8c-.8 0-1.4.6-1.4 1.4v62c0 .8.6 1.4 1.4 1.4h11.8c.8 0 1.4-.6 1.4-1.4v-62c0-.8-.6-1.4-1.4-1.4ZM431.7 16.6h11.8c.8 0 1.4-.6 1.4-1.3v-14c0-.8-.7-1.4-1.6-1.3L431.5 2a1.4 1.4 0 0 0-1.2 1.3v12c0 .8.6 1.4 1.4 1.4Zm-20.5 47.6V1.4c0-.9-.7-1.5-1.5-1.4L397.9 2a1.4 1.4 0 0 0-1.2 1.3V67c0 3 0 21.6 22.4 22.3a1.4 1.4 0 0 0 1.5-1.4v-9.5c0-.7-.5-1.3-1.2-1.4-8.2-.9-8.2-11-8.2-12.7Zm-30.7-31c-2.6-2.8-5.8-5-9.6-6.5a31.7 31.7 0 0 0-12-2.3c-4.5 0-8.5.7-12.2 2.3A27.9 27.9 0 0 0 331 43.5a39.6 39.6 0 0 0 0 26.3c1.5 4 3.6 7.5 6.2 10.3 2.6 2.9 5.8 5 9.5 6.7a38 38 0 0 0 12.2 2.4c2.8 0 8.6-.9 12.3-2.4a27 27 0 0 0 9.5-6.7 35.1 35.1 0 0 0 8.3-23c0-4.9-.8-9.6-2.4-13.6-1.5-4-3.5-7.4-6.1-10.2ZM370 71.5a13.1 13.1 0 0 1-11.2 5.6 13 13 0 0 1-11.2-5.6c-2.7-3.6-4-7.9-4-14.2 0-6.3 1.3-11.5 4-15.1a13 13 0 0 1 11.1-5.5 13 13 0 0 1 11.3 5.5c2.6 3.6 4 8.8 4 15 0 6.4-1.3 10.6-4 14.3Zm-161.6-47H197a32 32 0 0 0-27 15 33.8 33.8 0 0 0 8.9 45.9 18.8 18.8 0 0 0 11.2 3.1H191.2l.6-.2h.2a21 21 0 0 0 16.5-14.6V87c0 .8.6 1.4 1.4 1.4h11.7c.8 0 1.4-.6 1.4-1.4V25.8c0-.8-.6-1.4-1.4-1.4h-13Zm0 48.3a17.8 17.8 0 0 1-10.4 3.5h-.2a12.5 12.5 0 0 1-.7 0A18.4 18.4 0 0 1 180.4 51c2.7-6.8 9-11.6 16.6-11.6h11.5v33.3Zm289-48.3H486a32 32 0 0 0-27 15 33.8 33.8 0 0 0 8.8 45.9 18.8 18.8 0 0 0 11.3 3.1h1.1l.6-.2h.2a21 21 0 0 0 16.5-14.6V87c0 .8.6 1.4 1.4 1.4h11.7c.8 0 1.4-.6 1.4-1.4V25.8c0-.8-.6-1.4-1.4-1.4h-13.1Zm0 48.3a17.8 17.8 0 0 1-10.5 3.5h-.9A18.4 18.4 0 0 1 469.4 51c2.6-6.8 9-11.6 16.6-11.6h11.5v33.3ZM306.3 24.4h-11.5a32 32 0 0 0-27 15 33.7 33.7 0 0 0-5.1 14.6 34.6 34.6 0 0 0 0 7.6c1 8.9 5.4 16.7 11.8 22a19.5 19.5 0 0 0 2.2 1.7 18.8 18.8 0 0 0 21.6-.6c3.8-2.7 6.7-6.7 8-11.1V87.9c0 5-1.3 8.9-4 11.5-2.7 2.6-7.3 3.9-13.6 3.9-2.6 0-6.7-.2-10.9-.6a1.4 1.4 0 0 0-1.4 1l-3 10a1.4 1.4 0 0 0 1.1 1.8c5 .7 10 1 12.8 1 11.4 0 19.8-2.4 25.3-7.4 5-4.6 7.8-11.4 8.2-20.7V25.8c0-.8-.6-1.4-1.3-1.4h-13.2Zm0 15s.2 32.4 0 33.4a17.5 17.5 0 0 1-10 3.4h-.2a13.6 13.6 0 0 1-1.7 0A18.7 18.7 0 0 1 278.3 51c2.6-6.8 9-11.6 16.5-11.6h11.5ZM58.2 0A58.3 58.3 0 1 0 86 109.5c.9-.5 1-1.6.3-2.2l-5.5-4.9a3.8 3.8 0 0 0-4-.6A47 47 0 0 1 11 57.5 47.3 47.3 0 0 1 58.2 11h47.3v84L78.7 71.2a2 2 0 0 0-3 .3 22 22 0 1 1 4.4-15.2 4 4 0 0 0 1.3 2.6l7 6.2c.8.7 2 .3 2.3-.8a33 33 0 0 0-30.4-39 33 33 0 0 0-35 32 33.3 33.3 0 0 0 32.2 33.9 32.8 32.8 0 0 0 20-6.3l35.1 31c1.5 1.4 3.9.3 3.9-1.7V2.2a2.2 2.2 0 0 0-2.2-2.2h-56Z"></path></svg></a></li><li class="algc-navigation__li"><a class="algc-badge algc-navigation__navitem" href="./"><svg class="algc-arrowseparator" viewbox="0 0 18 35" xmlns="http://www.w3.org/2000/svg"><path d="M1.8537 34.7643l15.5597-17.268L1.8537 0H0l15.5597 17.4964L0 34.7644z" fill="#3369E6"></path></svg><span>algoliasearch-helper</span></a></li></ul><div class="algc-navigation__menu"><ul class="algc-menu__list"><li class="algc-menu__list__item"><a href="gettingstarted.html">Getting started</a></li><li class="algc-menu__list__item"><a href="concepts.html">Concepts</a></li><li class="algc-menu__list__item"><a href="reference.html">Reference</a></li><li class="algc-menu__list__item"><a href="examples.html">Examples</a></li><li class="algc-menu__list__item"><a href="upgrade.html">Upgrade</a></li></ul><button class="algc-openmobile"><span></span></button></div></div></div><div class="algc-mobilemenu"><div class="algc-mobilemenuwrapper"><ul class="algc-mobilemenulist"><li class="algc-mobilemenu__item"><a href="gettingstarted.html">Getting started</a></li><li class="algc-mobilemenu__item"><a href="concepts.html">Concepts</a></li><li class="algc-mobilemenu__item"><a href="reference.html">Reference</a></li><li class="algc-mobilemenu__item"><a href="examples.html">Examples</a></li></ul></div></div></nav><section class="hero-section shrink"><div class="container"><div class="hero-container"><div class="fl-right"><img src="images/al-helper-logo.svg"></div><div class="fl-left"><a href="https://www.algolia.com/?utm_medium=social-owned&amp;utm_source=algoliasearch-helper%20website&amp;utm_campaign=homepage" title="Algolia built this"><span class="icon icon-algolia-small no-mobile" id="icon-algolia"></span></a><h1>Helper core concepts</h1></div></div></div></section><section class="documentation-section"><div class="container"><nav class="sidebar"><ul><li class="level-h2"><a href="#high-level-concepts">High level concepts</a></li><li class="level-h3"><a href="#search-flow">Search flow</a></li><li class="level-h3"><a href="#the-source-of-truth-of-the-ui">The source of truth of the UI</a></li><li class="level-h2"><a href="#managed-parameters">Managed parameters</a></li><li class="level-h3"><a href="#numerical-filters">Numerical filters</a></li><li class="level-h3"><a href="#conjunctive-and-excluding-facets">Conjunctive and excluding facets</a></li><li class="level-h3"><a href="#disjunctive-faceting">Disjunctive faceting</a></li><li class="level-h3"><a href="#hierarchical-faceting">Hierarchical faceting</a></li><li class="level-h2"><a href="#special-capabilities">Special capabilities</a></li><li class="level-h3"><a href="#event-based">Event based</a></li><li class="level-h3"><a href="#chainability">Chainability</a></li><li class="level-h3"><a href="#immutability-of-the-search-parameters">Immutability of the search parameters</a></li><li class="level-h3"><a href="#derivations-of-the-helper-multi-queries">Derivations of the helper: multi-queries</a></li><li class="level-h3"><a href="#smart-page-behaviour">Smart page behaviour</a></li><li class="level-h2"><a href="#final-words-and-where-to-go-next">Final words and where to go next</a></li></ul></nav><div class="documentation-container"><h2 id="high-level-concepts">High level concepts</h2>
<h3 id="search-flow">Search flow</h3>
<p>The search flow is the cycle between the UI and the search engine.
When a user updates a parameter in the UI, a new search is triggered,
and new results appear. Not only these results are updated, but
also all the filters available should be too.</p>
<p><img src="images/concepts/search-cycle.svg" alt="The search flow"></p>
<h3 id="the-source-of-truth-of-the-ui">The source of truth of the UI</h3>
<p>The Helper stores and keeps track of the successive filters applied in
your search UI. It is the source of truth for your search parameters. This
makes all the UI components that you use independent from each other while
still being able to trigger the search. For example, the text search input
will only set the <code>query</code> whereas the category list will only deal with
facets. But both will trigger the search with the parameters of the other.</p>
<p><img src="images/concepts/search-states.svg" alt="Search states"></p>
<p>Changing the parameters of the search with the Helper does not trigger the 
search. Instead the changes are stored until the <code>search</code> method is called.
Taking the first schema for reference, the updates look like that:</p>
<p><img src="images/concepts/setting-parameters.svg" alt="Setting parameters"></p>
<h2 id="managed-parameters">Managed parameters</h2>
<p>Most of the parameters on the Algolia Rest API are simple, strings (eg. <code>query</code>
which is the fulltext input of the search), numbers (eg. <code>hitsPerPage</code> which
configures the numbers of records returned per response). But some are trickier
and delivers great expressivity. For example, you can specify ranges of values
for numerical attributes. You can also define facets on string based attributes,
which let you filter on specific values.</p>
<p>Managing those kind of parameters is hard in a UI context because you need:</p>
<ul>
<li>to know the current state</li>
<li>to manipulate specifically the part, the UI component is responsible for</li>
</ul>
<p>And of course, you don&#39;t want to manipulate a deep structure of arrays and
objects by hand.</p>
<p>That&#39;s why the filtering APIs are presented as methods on the Helper instance.
These methods let you edit those filters rather than input the strings themselves.
We still keep the ability to input the string parameters, but this interface
(that we call <strong>raw</strong>) is exclusive with the higher level one (that we call <strong>managed</strong>)</p>
<p>This layer on top of the Algolia API even lets us create features that don&#39;t
exist in the Rest API. We have created some features that rely on multiple
queries based on the pattern we found over time.</p>
<p>On and on, the overall idea of those managed API&#39;s is to make the usage of
Algolia filters as easy as possible. Some are mainly adaptation of the API,
like Numerical, Facets and Excluding Facets, but others are more complex and
bring new features.</p>
<h3 id="numerical-filters">Numerical filters</h3>
<p>The numerical filters brings the ability to manage constraints over numerical
attributes. For each attribute, you can combine sets of constraints. Those
filters for any numerical data, but also with dates if converted to timestamps
in the records.</p>
<h3 id="conjunctive-and-excluding-facets">Conjunctive and excluding facets</h3>
<p>With facets, you can filter in or out the results based on the values that an
attribute can take. Let&#39;s take an example: </p>
<pre><code class="hljs js">[
  { name: <span class="hljs-string">'Paris'</span>,
    type: [<span class="hljs-string">'city'</span>, <span class="hljs-string">'capital'</span>] },
  { name: <span class="hljs-string">'Marseille'</span>,
    type: [<span class="hljs-string">'city'</span>] },
  { name: <span class="hljs-string">'London'</span>,
    type: [<span class="hljs-string">'city'</span>, <span class="hljs-string">'capital'</span>]}
]</code></pre>

<p>These three records represent cities. If we facet <code>type</code>, Algolia will
return the list of available values (city, capital) and will let us
filter using those values.</p>
<p>With conjunctive facets you express that you want two or more values
combined with AND. With excluding facets, you express that you <strong>DO NOT</strong>
want values.</p>
<p>These facets need to be declared so that the values can be retrieved and
then filtered through the UI (<a href="reference.html#conjunctive-facets">see the configuration</a>).</p>
<h3 id="disjunctive-faceting">Disjunctive faceting</h3>
<p>With Algolia you can retrieve for each faceted attribute the most used
values in your results. This means that if a value is not in your
results, you won&#39;t be aware of its existence. This can be inconvenient when
you want your user to be able to select many values and combine them with an OR
condition, because once you&#39;ve selected a value the other that could
be chosen won&#39;t be returned by Algolia.</p>
<p>Let&#39;s take an example. Imagine your dataset contains high-tech products.
And those products are categorized. Amongst those products you have TVs
and video projectors, each in their own category. By default, if you select
TV then only the TV will be returned and therefore the facet values for the
category will only be TV.</p>
<p><img src="images/concepts/conjunctive-facets.svg" alt="conjunctive facets"></p>
<p>The purpose of the disjunctive facets is to be able to search further than
a single facet filter. To do that, the helper implements a second request that
will be specifically tailored to retrieve the other facet values possible for
a specific faceted attribute.</p>
<p>Going back to our example, the first request retrieves the results and a second
one will retrieve the values for the category attribute. When the results come
back from Algolia the two requests will be merged and a single list of values
will be created.</p>
<p><img src="images/concepts/disjunctive-facets.svg" alt="disjunctive facets"></p>
<p>These facets need to be declared so that the values can be retrieved and
then filtered through the UI (<a href="reference.html#disjunctive-facets">see the configuration</a>).</p>
<h3 id="hierarchical-faceting">Hierarchical faceting</h3>
<p>The hierarchical facets extends the concepts used in the disjunctive faceting
in order to be able to organize the values in a tree like fashion.</p>
<p>When using the same high-tech e-shop example (see the previous paragraph about
<a href="#disjunctive-faceting">disjunctive faceting</a>), we can imagine that TV and video
projectors are organized in a higher category called video hardware.</p>
<p>The structure inside the record should contain all the variations per level. For a
product in the TV category, the record will have a <code>lvl1</code> attribute that will contain
<code>video hardware</code> and a <code>lvl2</code> that will contain <code>video hardware &gt; TV</code>. With the
hierarchical feature, you can facet values per level and you will be provided the correct
hierarchy of facet values.</p>
<pre><code class="hljs markdown"><span class="hljs-bullet">- </span>Video hardware
   - TV
   - DVR
 - Kitchen</code></pre>

<p>Since this is a feature built on top of the Algolia API, we expect the dataset to
follow a hierarchical notation (<a href="reference.html#hierarchical-facets">see the configuration</a>).</p>
<h2 id="special-capabilities">Special capabilities</h2>
<p>What makes the special sauce of the Helper is a conjunction of patterns and
smart tricks to help you make the best search UI:</p>
<ul>
<li>chainable API</li>
<li>event-based</li>
<li>immutable model</li>
<li>smart page handling</li>
</ul>
<h3 id="event-based">Event based</h3>
<p>In UIs, it&#39;s very likely that you will have more than a single point where you
want to update and trigger a new search. On the other hand, it&#39;s very unlikely
that where you want to update the UI will be at the same place.</p>
<p>For those reasons, the Helper implements events. There are four kinds of events
on the Helper : </p>
<ul>
<li><code>change</code>: triggered when a parameter is set or updated</li>
<li><code>search</code>: triggered when the search is sent to Algolia</li>
<li><code>result</code>: triggered when the results are retrieved Algolia</li>
<li><code>error</code>:  triggered when Algolia sends back an error</li>
</ul>
<p><img src="images/concepts/Events.svg" alt="Search states"></p>
<h3 id="chainability">Chainability</h3>
<p>All the write operations of the Helper are chainable. This means that
all those methods will return the Helper object. This leads to a more
concise way to express the operations done on the helper.</p>
<p>For example, setting the query and triggering the search looks like that,
thanks to the chainability:</p>
<pre><code class="hljs js">helper.setQuery(<span class="hljs-string">'tv'</span>)
      .search();</code></pre>

<h3 id="immutability-of-the-search-parameters">Immutability of the search parameters</h3>
<p>An immutable object is an object which values cannot be modified after it is
created. For example, in Javascript strings are immutable. This means that
you can&#39;t directly change the value and each write operation will return a new
object.</p>
<p>Inside the Helper, we use an immutable object to store the search parameters. The
Helper write and read methods are proxies to the search parameters object.</p>
<p>For example, when the setQuery method is called it is forwarded to the search
parameters. This will create a new instance of the search parameters, which
will replace the <code>state</code> property of the helper, and finally the helper will
emit the <code>change</code> event.</p>
<p>The immutability of the search parameters has some interesting usage:</p>
<ul>
<li>each search parameter is stored when the request is sent to Algolia, and
provided back when the <code>result</code> event is fired.</li>
<li>if we want to create urls with different parameters, we can reuse the search
parameters object and its api to create new states that we can serialize.</li>
</ul>
<p><img src="images/concepts/state-is-immutable.svg" alt="Search states"></p>
<h3 id="derivations-of-the-helper-multi-queries">Derivations of the helper: multi-queries</h3>
<p>Derivation is the ability to create virtual helpers to be able to generate
requests based on the main JS Helper instance. For example, with this feature,
you can:</p>
<ul>
<li>query two indices at the same time.</li>
<li>search in the same index with different parameters.</li>
</ul>
<p>The virtual helpers are created by calling the <a href="reference.html#AlgoliaSearchHelper#derive">derive</a> method with a <em>derivation
function</em>. The derivation function is used when <code>search</code> is called. For each
derivated Helper, it will derive a new state from the main. All of those requests
will be sent together along the main helper request. When Algolia answers come back,
the results will be dispatched to each helper via events (<code>error</code> or <code>result</code>).</p>
<p>Here is a schematic view of the process happening during a search with derivated helpers:</p>
<img src="images/concepts/derive-simplified.svg" alt="derivation" style="max-width: 100%;margin: 0 5%;">

<p>This schema only present a single derivated helper but there can be more than one.</p>
<h3 id="smart-page-behaviour">Smart page behaviour</h3>
<p>In a search engine, the most relevant results are always on the first page.
And each new set of parameters sent to Algolia will return a new set of
results. This means that each time the parameters are changed, the most relevant
will be on the very first page. Also, each new set of parameters might change
the number of available pages. Therefore, when the parameters are changed the
page should be set to 0. This would lead to writing such code for each kind of
settings to be set:</p>
<pre><code class="hljs js"><span class="hljs-comment">// When we set the query</span>
helper.setQuery(query)
      .setPage(<span class="hljs-number">0</span>)
      .search();

<span class="hljs-comment">// When we change a tag filter</span>
helper.toggleTag(tag)
      .setPage(<span class="hljs-number">0</span>)
      .search();</code></pre>

<p>To avoid this kind of repetition, all the write methods on the helper will set
the page to 0 with the exception of <code>setPage</code>. This is not the case for write
methods on the immutable search parameters.</p>
<h2 id="final-words-and-where-to-go-next">Final words and where to go next</h2>
<p>Congratulations for reading our high level presentation of the Helper. We hope that
you have now a better understanding of what makes the Helper very useful when building
instantsearch UI&#39;s.</p>
<p>If you haven&#39;t already, we suggest that you have a look at the
<a href="gettingstarted.html">getting started</a> to quickly start your very own search. If you
are more interested in going in-depth the helper, be sure to check out:</p>
<ul>
<li><a href="reference.html">The reference API</a></li>
<li><a href="examples.html">The examples</a></li>
</ul>
<p>If after all, you think that you need a more comprehensive and widget-based library,
we made <a href="https://community.algolia.com/instantsearch.js/">instantsearch.js</a> for that.</p>
</div></div></section><section class="ac-footer"><div class="ac-footer-container"><p class="ac-footer-links">Code licensed under<a class="ac-footer-link-item" href="https://raw.githubusercontent.com/algolia/algoliasearch-helper-js/master/LICENSE">MIT</a><br><a class="ac-footer-link-item" href="https://github.com/algolia/algoliasearch-helper-js">GitHub</a><a class="ac-footer-link-item" href="https://github.com/algolia/algoliasearch-helper-js/issues">issues</a></p></div><div class="ac-footer-container ac-footer-brand"><p>This project is part of</p><img class="ac-footer-brand-icon" src="images/community-badge.svg"><figure><img class="ac-footer-brand-logo" src="https://res.cloudinary.com/hilnmyskv/image/upload/v1484219849/algolia-community-logo-words-darkbg.svg"><figcaption>Algolia Community</figcaption></figure><a class="ac-footer-btn ac-footer-btn-cta" href="https://community.algolia.com/">See More</a><span class="ac-icon ac-icon-love-dark"></span></div><p class="ac-footer-version">Latest version: 3.13.0</p><div class="ac-footer-actions"><div class="footer-container"><p>Build unique search experiences with Algolia</p><a class="ac-footer-btn ac-footer-btn-ghost-grey" href="https://www.algolia.com/why?utm_medium=social-owned&amp;utm_source=helper%20website&amp;utm_campaign=homepage&amp;utm_term=why">See Why<span class="ac-icon-triangle"></span></a><a class="ac-footer-btn ac-footer-btn-ghost-pink" href="https://www.algolia.com/users/sign_up?utm_medium=social-owned&amp;utm_source=helper%20website&amp;utm_campaign=homepage&amp;utm_term=get_started">Get Started For Free</a></div></div></section><script src="js/main.js"></script></body></html>